<!-- 
  Template de la page d'accueil administrateur
  Affiche la liste des événements avec options de gestion
-->

<!-- Header avec titre et bouton de déconnexion -->
<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>
      <ion-icon name="person-circle" slot="start"></ion-icon>
      Tableau de bord Admin
    </ion-title>
    
    <!-- Bouton de déconnexion dans le header -->
    <ion-buttons slot="end">
      <ion-button (click)="logout()">
        <ion-icon name="log-out" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- Contenu principal -->
<ion-content [fullscreen]="true">
  <!-- Message de chargement pendant la récupération des données -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Chargement des événements...</p>
  </div>

  <!-- Affichage quand aucun événement n'existe -->
  <div *ngIf="!isLoading && events.length === 0" class="empty-state">
    <ion-icon name="calendar" class="empty-icon"></ion-icon>
    <h2>Aucun événement</h2>
    <p>Commencez par créer votre premier événement communautaire</p>
    <ion-button (click)="goToCreateEvent()" expand="block">
      <ion-icon name="add" slot="start"></ion-icon>
      Créer un événement
    </ion-button>
  </div>

  <!-- Liste des événements sous forme de cards -->
  <div *ngIf="!isLoading && events.length > 0" class="events-container">
    <!-- Header de section -->
    <div class="section-header">
      <h2>Mes événements ({{ events.length }})</h2>
    </div>

    <!-- Boucle sur chaque événement -->
    <ion-card *ngFor="let event of events" class="event-card">
      <!-- Image de l'événement -->
      <img 
        [src]="event.imageUrl" 
        [alt]="event.nom"
        class="event-image"
      />

      <!-- Header de la card avec titre et sous-titre -->
      <ion-card-header>
        <ion-card-title>{{ event.nom }}</ion-card-title>
        <ion-card-subtitle>
          <!-- Icône et date -->
          <ion-icon name="calendar"></ion-icon>
          {{ formatDate(event.dateDebut) }}
        </ion-card-subtitle>
      </ion-card-header>

      <!-- Contenu de la card -->
      <ion-card-content>
        <!-- Description de l'événement -->
        <p class="event-description">{{ event.description }}</p>

        <!-- Informations supplémentaires -->
        <div class="event-info">
          <!-- Lieu -->
          <div class="info-item">
            <ion-icon name="location"></ion-icon>
            <span>{{ event.lieu }}</span>
          </div>

          <!-- Nombre de participants -->
          <div class="info-item">
            <ion-icon name="people"></ion-icon>
            <span>
              {{ event.participantsCount }} / {{ event.nombreMaxParticipants }} participants
            </span>
          </div>
        </div>

        <!-- Bouton de suppression -->
        <ion-button 
          expand="block" 
          color="danger" 
          (click)="deleteEvent(event)"
          class="delete-button">
          <ion-icon name="trash" slot="start"></ion-icon>
          Supprimer l'événement
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Bouton flottant pour créer un nouvel événement -->
  <!-- Visible uniquement quand il y a déjà des événements -->
  <ion-fab 
    *ngIf="!isLoading && events.length > 0" 
    slot="fixed" 
    vertical="bottom" 
    horizontal="end">
    <ion-fab-button color="secondary" (click)="goToCreateEvent()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>